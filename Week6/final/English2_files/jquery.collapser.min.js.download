!function(e,t,o,a){function n(t,o){var a=this;a.o=e.extend({},l,o),a.e=e(t),a.init()}var i="collapser",l={target:"next",mode:"words",speed:"slow",truncate:10,ellipsis:"...",effect:"fade",controlBtn:"",showText:"Show more",hideText:"Hide text",showClass:"show-class",hideClass:"hide-class",atStart:"hide",lockHide:!1,dynamic:!1,changeText:!1,beforeShow:null,afterShow:null,beforeHide:null,afterHide:null,linesUseText:!0};n.prototype={init:function(){var o=this;o.mode=o.o.mode,o.remaining={},o.ctrlHtml=' <a href="#" data-ctrl class="'+(e.isFunction(o.o.controlBtn)?"":o.o.controlBtn)+'"></a>',e(o.e).each(function(){e(this).data("oCnt",o.e.html());var t=e.isFunction(o.o.atStart)?o.o.atStart.call(o.e):o.o.atStart;t="undefined"!=typeof o.e.attr("data-start")?o.e.attr("data-start"):t,"hide"==t?o.hide(o.e,0):o.show(o.e,0)});var a;e(t).on("resize",function(){o.o.dynamic&&"lines"==o.mode&&(clearTimeout(a),a=setTimeout(function(){o.reInit(o.e)},100))})},show:function(t,o){var a=this,n=e(t);"undefined"==typeof o&&(o=a.o.speed);var i=function(){e.isFunction(a.o.afterShow)&&a.o.afterShow.call(a.e,a)};switch(e.isFunction(a.o.beforeShow)&&a.o.beforeShow.call(a.e,a),a.mode){case"chars":case"words":var l=n.height();n.html(n.data("tHTML"));var s=n.height();n.height(l),n.animate({height:s},o,function(){n.height("auto"),i()}).removeClass(a.o.hideClass).addClass(a.o.showClass),n.data("tHTML",n.html());break;case"lines":0==n.children("div").length&&n.wrapInner("<div>");var c=n.children("div"),r=c.height(),h=c.html(n.data("oCnt")).css("height","").height();c.css("height",r);c.animate({height:h},o,function(){c.height("auto"),i()}),n.removeClass(a.o.hideClass).addClass(a.o.showClass);break;case"block":a.blockMode(n,"show",o,i)}return a.status=1,1==a.o.lockHide?(n.find("[data-ctrl]").remove(),""):void("block"==a.mode?n.off("click.coll").on("click.coll",function(e){e.preventDefault(),a.hide(n)}):(0!=n.find("[data-ctrl]").length||e.isFunction(a.o.controlBtn)||n.append(a.ctrlHtml),a.ctrlBtn=e.isFunction(a.o.controlBtn)?a.o.controlBtn.call(a.e):e(n.find("[data-ctrl]")),a.ctrlBtn.off("click.coll").on("click.coll",function(e){e.preventDefault(),a.hide(n)}).html(a.o.hideText)))},hide:function(t,o){var a=this,n=e(t);"undefined"==typeof o&&(o=a.o.speed);var i=function(){e.isFunction(a.o.afterHide)&&a.o.afterHide.call(a.e,a)};switch(e.isFunction(a.o.beforeHide)&&a.o.beforeHide.call(a.e,a),n.find("[data-ctrl]").remove(),a.mode){case"chars":var l=e.trim(n.text());a.remaining.chars=l.length-a.o.truncate,l.length>a.o.truncate&&(n.data("tHTML",n.html()),l=a.pad(l.slice(0,a.o.truncate),l.slice(a.o.truncate,l.length)),n.html(l).removeClass(a.o.showClass).addClass(a.o.hideClass),i());break;case"words":var l=e.trim(n.text()),s=l.split(" ");a.remaining.words=s.length-a.o.truncate,s.length>a.o.truncate&&(n.data("tHTML",n.html()),l=a.pad(s.slice(0,a.o.truncate).join(" "),s.slice(a.o.truncate,s.length).join(" ")),n.html(l).removeClass(a.o.showClass).addClass(a.o.hideClass),i());break;case"lines":0==n.children("div").length&&n.wrapInner("<div>");var c=n.children("div").css("height","");a.o.linesUseText&&c.html(c.text());var r=c.height();"undefined"==typeof n.data("lHeight")?(temp=c.clone(),lHeight=temp.text("a").insertAfter(c).height(),n.data("lHeight",lHeight),c.next().remove()):lHeight=n.data("lHeight"),lines=r/lHeight,a.remaining.lines=lines-a.o.truncate,a.remaining.lines>0&&(c.css("overflow","hidden"),c.animate({height:lHeight*a.o.truncate},o).data("tHeight",r),n.removeClass(a.o.showClass).addClass(a.o.hideClass),0!=n.find("[data-ctrl]").length||e.isFunction(a.o.controlBtn)||n.append(a.ctrlHtml),i());break;case"block":a.blockMode(n,"hide",o,i)}if(a.status=0,"block"==a.mode)n.unbind("click.coll").bind("click.coll",function(e){e.preventDefault(),a.show(n)});else{a.ctrlBtn=e.isFunction(a.o.controlBtn)?a.o.controlBtn.call(a.e):e(n.find("[data-ctrl]")),a.ctrlBtn.off("click.coll").on("click.coll",function(e){e.preventDefault(),a.show(n)}).html(a.o.showText);var h=a.o.showText,d={chars:["character","characters"],words:["word","words"],lines:["lines","lines"]},f=a.remaining[a.mode]+(1==a.remaining[a.mode]?" "+d[a.mode][0]:" "+d[a.mode][1]);h=h.replace("%s",f),a.ctrlBtn.html(h)}},pad:function(t,o){var a=this;return t+'<span class="coll-ellipsis">'+a.o.ellipsis+"</span>"+(e.isFunction(a.o.ctrlBtn)?"":a.ctrlHtml)+'<span class="coll-hidden" style="display:none">'+o+"</span>"},blockMode:function(t,o,a,n){var i=this,l=["fadeOut","slideUp","fadeIn","slideDown"],s="fade"==i.o.effect?0:1,c="hide"==o?l[s]:l[s+2];e.isFunction(i.o.target)?i.o.target.call(i.e)[c](a,n):e.fn[i.o.target]&&e(t)[i.o.target]()[c](a,n),"show"==o?(t.removeClass(i.o.showClass).addClass(i.o.hideClass),i.o.changeText&&t.text(i.o.hideText)):(t.removeClass(i.o.hideClass).addClass(i.o.showClass),i.o.changeText&&t.text(i.o.showText))},reInit:function(e){var t=this;e.find("[data-ctrl]").remove(),"chars"==t.mode,e.html(t.e.data("oCnt")),0==t.status?t.hide(e,0):t.show(e,0)}},e.fn[i]=function(t){return this.each(function(){e.data(this,i)||e.data(this,i,new n(this,t))})}}(jQuery,window,document);
